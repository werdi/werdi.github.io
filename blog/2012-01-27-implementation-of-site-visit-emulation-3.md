---
title: C# или VB.Net. Программная реализация эмуляции посещения сайта 3
tags: [c#, webbrowser]
src: https://social.msdn.microsoft.com/Forums/ru-RU/7a42f2ab-7b49-4fc7-abaf-9cbe9b5b9d82/c-vbnet-3?forum=programminglanguageru
---
# C# или VB.Net. Программная реализация эмуляции посещения сайта 3
*> После нажатия этой кнопки страница выполняей какие-то манипуляции с данными, после чего этими новыми данными  заполняется другая форма на этой же странице (адрес страницы тот же).*

скорее всего было обращение к серверу. при этом страница/контент меняется, а адрес остается прежним.

*> Как сделать, что бы webBrowser1 перед нажатием второй кнопки подождал, пока выполнятся все действия связанные с нажатием первой кнопки?*

см. [здесь] (http://social.msdn.microsoft.com/Forums/ru-RU/programminglanguageru/thread/a85cda10-6d68-4f57-8fa4-747ec9e4fa13/#9d622be8-6f45-4691-bb29-0932871bbaf7)

*> не могу по тому варианту разобраться (что Вы указали в "здесь").*
```c#
Handler Fly1(WebBrowser wb)
{
   // из "fly()" копируем сюда все, что находится в блоке try { ... } 
   // и меняем "this.webBrowser1" на "wb" 

   return Fly2;
}
Handler Fly2(WebBrowser wb)
{
   // из "fly_2()" копируем сюда все, что находится в блоке try { ... }
   // и меняем "this.webBrowser1" на "wb"

   return null;
 }
 ```
 *> После нажатия этой кнопки страница выполняей какие-то манипуляции с данными, после чего этими новыми данными  заполняется другая форма на этой же странице (адрес страницы тот же).*
 
как данные передаются на сервер? если используется JQuery.post или что-то подобное, то 
WebBrowser.DocumentCompleted не будет работать.

*> А как это узнать?*

смотреть на javascript. но т.к. задача в том, чтобы перехватить момент передачи и получения данных от сервера, то сделать это можно: 1. через интерфейсы браузера (см. [The most complete C# Webbrowser wrapper control] (http://www.codeproject.com/Articles/18935/The-most-complete-C-Webbrowser-wrapper-control)); 2. с помощью [FiddlerCore] (http://www.fiddler2.com/Fiddler/Core/)

*> писать запросы без использования веб-браузера, с помощью WebClient или WebRequest/WebResponse.*

бывает, что для защиты в каждый запрос встраивают хитрые проверочные данные с помощью javascript'а. поэтому в такой ситуации WebClient или WebRequest/WebResponse не помогут.
